\doxysection{categorizer.\+py}
\hypertarget{categorizer_8py_source}{}\label{categorizer_8py_source}\index{TracknTrace/TracknTrace/categorizer/categorizer.py@{TracknTrace/TracknTrace/categorizer/categorizer.py}}
\mbox{\hyperlink{categorizer_8py}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00001}\mbox{\hyperlink{namespace_trackn_trace_1_1categorizer_1_1categorizer}{00001}}\ \textcolor{keyword}{import}\ pandas\ \textcolor{keyword}{as}\ pd}
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00002}00002\ \textcolor{keyword}{import}\ argparse}
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00003}00003\ \textcolor{keyword}{import}\ configparser}
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00004}00004\ }
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00005}\mbox{\hyperlink{namespace_trackn_trace_1_1categorizer_1_1categorizer_ad46530db38f9cae023847546641d801f}{00005}}\ pd.options.plotting.backend\ =\ \textcolor{stringliteral}{"{}plotly"{}}}
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00006}\mbox{\hyperlink{namespace_trackn_trace_1_1categorizer_1_1categorizer_aa8d54c4043f02951bacad7522e761ad6}{00006}}\ pd.options.mode.chained\_assignment\ =\ \textcolor{keywordtype}{None}}
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00007}00007\ }
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00008}\mbox{\hyperlink{namespace_trackn_trace_1_1categorizer_1_1categorizer_a5a12c4b170ee9c7c3eee10aa3900bb2f}{00008}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespace_trackn_trace_1_1categorizer_1_1categorizer_a5a12c4b170ee9c7c3eee10aa3900bb2f}{EventCategorizerFcn}}(categories,\ data,\ cats,\ target):\ \textcolor{comment}{\#\ list,\ data,\ df}}
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00009}00009\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Creates\ map\ of\ category:data\ and\ sums\ results\ per\ category}}
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00010}00010\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00011}00011\ \textcolor{stringliteral}{\ \ \ \ @param\ categories\ \ data\ column:\ category\ translation\ pairs}}
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00012}00012\ \textcolor{stringliteral}{\ \ \ \ @param\ data\ \ original\ data\ to\ categorize}}
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00013}00013\ \textcolor{stringliteral}{\ \ \ \ @param\ cats\ \ Scaling\ of\ detected\ event}}
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00014}00014\ \textcolor{stringliteral}{\ \ \ \ @param\ target\ \ The\ target\ trends\ in\ data\ to\ dp\ event\ categorization\ on.}}
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00015}00015\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00016}00016\ \textcolor{stringliteral}{\ \ \ \ @return\ df\ \ dataframe\ which\ dumps\ original\ data\ and\ replaces\ with\ event\ detections\ for\ target"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00017}00017\ \ \ \ \ df\ =\ pd.DataFrame(columns\ =\ categories[0][1:],\ index\ =\ data.index)}
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00018}00018\ \ \ \ \ df\ =\ \ df.fillna(0.0)}
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00019}00019\ \ \ \ \ print(df)}
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00020}00020\ \ \ \ \ TargetOrigin\ =\ target.split(\textcolor{stringliteral}{"{}\_"{}})[1]}
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00021}00021\ \ \ \ \ \textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ data[[target]].T:}
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00022}00022\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#print(i,\ data[[target]].T[i],\ float(data[[target]].T[i])*cats.loc[TargetOrigin])}}
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00023}00023\ \ \ \ \ \ \ \ \ df.T[i]\ +=\ float(data[[target]].T[i].iloc[0])*cats.loc[TargetOrigin]\textcolor{comment}{\#\ \#\#\ \$\ FINALLY\ TYHIS\ DOESD\ OETGIOGFEIHAOFAWIO\{WFG}}
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00024}00024\ \ \ \ \ \textcolor{keywordflow}{return}\ df}
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00025}00025\ }
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00026}\mbox{\hyperlink{namespace_trackn_trace_1_1categorizer_1_1categorizer_a383060e49080dec23300b5de83f90b1b}{00026}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespace_trackn_trace_1_1categorizer_1_1categorizer_a383060e49080dec23300b5de83f90b1b}{DoAllCategories}}(categories,\ data,\ cats,\ ScanList\ =\ None):\ \textcolor{comment}{\#\ list,\ data,\ df}}
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00027}00027\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Creates\ map\ of\ category:data\ and\ sums\ results\ per\ category\ for\ all\ data}}
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00028}00028\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00029}00029\ \textcolor{stringliteral}{\ \ \ \ @param\ categories\ \ data\ column:\ category\ translation\ pairs}}
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00030}00030\ \textcolor{stringliteral}{\ \ \ \ @param\ data\ \ original\ data\ to\ categorize}}
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00031}00031\ \textcolor{stringliteral}{\ \ \ \ @param\ cats\ \ Scaling\ of\ detected\ event}}
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00032}00032\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00033}00033\ \textcolor{stringliteral}{\ \ \ \ @return\ df\ \ dataframe\ which\ dumps\ original\ data\ and\ replaces\ with\ event\ detections\ for\ all\ data"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00034}00034\ \ \ \ \ df\ =\ pd.DataFrame(columns\ =\ categories[0],\ index\ =\ data.index)}
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00035}00035\ \ \ \ \ df\ =\ \ df.fillna(0.0)}
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00036}00036\ \ \ \ \ print(df)}
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00037}00037\ \ \ \ \ progress\ =\ len(data.columns)}
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00038}00038\ \ \ \ \ \textcolor{keywordflow}{for}\ z,j\ \textcolor{keywordflow}{in}\ enumerate(data.columns):}
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00039}00039\ \ \ \ \ \ \ \ \ print(\textcolor{stringliteral}{"{}doing\ \{\},\ \{\}\%"{}}.format(j,(z/progress)*100))}
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00040}00040\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}:}
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00041}00041\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ j\ !=\ \textcolor{stringliteral}{"{}normevents"{}}:}
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00042}00042\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ TargetOrigin\ =\ j.split(\textcolor{stringliteral}{"{}\_"{}})[1]}
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00043}00043\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ScanList\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}\ \textcolor{keywordflow}{or}\ TargetOrigin\ \textcolor{keywordflow}{in}\ ScanList:}
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00044}00044\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ data[[j]].T:}
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00045}00045\ }
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00046}00046\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#df.T[i]\ +=\ abs(float(data[[j]].T[i].iloc[0]))*cats.loc[TargetOrigin]\#\ \#\#\ \$\ FINALLY\ TYHIS\ DOESD\ OETGIOGFEIHAOFAWIO\{WFG}}
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00047}00047\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#print("{}Transponate:"{},df.T[i])}}
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00048}00048\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#print("{}loc:"{},df.loc[i,])}}
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00049}00049\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#print(df.T[i])}}
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00050}00050\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ df.loc[i]\ =\ df.loc[i,]\ +\ abs(float(data[[j]].loc[i,].iloc[0]))*cats.loc[TargetOrigin]}
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00051}00051\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#print(i,\ data[[j]].loc[i,],\ float(data[[j]].loc[i,].iloc[0])*cats.loc[TargetOrigin],\ df.loc[i])}}
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00052}00052\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{except}\ KeyError:}
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00053}00053\ \ \ \ \ \ \ \ \ \ \ \ \ print(\textcolor{stringliteral}{"{}\{\}\ does\ not\ exist"{}}.format(j))}
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00054}00054\ \ \ \ \ \textcolor{keywordflow}{return}\ df}
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00055}00055\ }
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00056}\mbox{\hyperlink{namespace_trackn_trace_1_1categorizer_1_1categorizer_a90eee7a4677ca8b1ed116364a24367f9}{00056}}\ parser\ =\ argparse.ArgumentParser()}
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00057}\mbox{\hyperlink{namespace_trackn_trace_1_1categorizer_1_1categorizer_a7aead736a07eaf25623ad7bfa1f0ee2d}{00057}}\ parser.add\_argument(\textcolor{stringliteral}{"{}instance"{}},\ type=str,}
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00058}\mbox{\hyperlink{namespace_trackn_trace_1_1categorizer_1_1categorizer_a81ae9faedaa69e3e28e2960a0548df8d}{00058}}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ help=\textcolor{stringliteral}{"{}Input\ Instance"{}})}
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00059}\mbox{\hyperlink{namespace_trackn_trace_1_1categorizer_1_1categorizer_a8187411843a6284ffb964ef3fb9fcab3}{00059}}\ args\ =\ parser.parse\_args()}
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00060}00060\ }
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00061}00061\ }
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00062}\mbox{\hyperlink{namespace_trackn_trace_1_1categorizer_1_1categorizer_aad68c7d49ea9b97b2b72b394a9ed105e}{00062}}\ EventData\ =\ pd.read\_csv(\textcolor{stringliteral}{"{}\{\}\_Events\_Export.csv"{}}.format(args.instance))}
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00063}\mbox{\hyperlink{namespace_trackn_trace_1_1categorizer_1_1categorizer_abd31afffb41ba70fdebb50032e9dfd4a}{00063}}\ EventData.set\_index(\textcolor{stringliteral}{"{}DateTime"{}},\ inplace=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00064}00064\ }
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00065}\mbox{\hyperlink{namespace_trackn_trace_1_1categorizer_1_1categorizer_af20b96457082b747b09590bd6bc97fed}{00065}}\ Finalcategories\ =\ pd.read\_csv(\textcolor{stringliteral}{"{}\{\}\_categories\_Export.csv"{}}.format(args.instance))}
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00066}00066\ Finalcategories.set\_index(\textcolor{stringliteral}{"{}Unnamed:\ 0"{}},\ inplace=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00067}00067\ }
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00068}00068\ }
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00069}00069\ print(EventData.describe())}
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00070}00070\ print(EventData)}
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00071}00071\ }
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00072}00072\ print(Finalcategories.describe())}
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00073}00073\ print(Finalcategories)}
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00074}00074\ }
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00075}00075\ print([list(Finalcategories),Finalcategories.values.tolist()])}
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00076}00076\ }
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00077}00077\ print(\textcolor{stringliteral}{"{}lets\ try\ to\ do\ the\ work!"{}})}
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00078}00078\ }
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00079}00079\ print(Finalcategories.index)}
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00080}00080\ }
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00081}\mbox{\hyperlink{namespace_trackn_trace_1_1categorizer_1_1categorizer_ad2256458892609d0533df5d72a7257ad}{00081}}\ config\ =\ configparser.ConfigParser()}
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00082}\mbox{\hyperlink{namespace_trackn_trace_1_1categorizer_1_1categorizer_a155c18f656ff370c96505001ae6bdfca}{00082}}\ config.optionxform\ =\ \textcolor{keyword}{lambda}\ option:\ option}
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00083}\mbox{\hyperlink{namespace_trackn_trace_1_1categorizer_1_1categorizer_ac4215aa0048085ed901f54e9c8f03225}{00083}}\ result\_list\ =\ config.read(\textcolor{stringliteral}{"{}\{\}.metadata"{}}.format(args.instance))}
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00084}\mbox{\hyperlink{namespace_trackn_trace_1_1categorizer_1_1categorizer_a97e2b41d9c6e115d29d704afdcbc9548}{00084}}\ Scanlist\ =\ config[\textcolor{stringliteral}{"{}eventdetection"{}}][\textcolor{stringliteral}{"{}Scanlist"{}}].split(\textcolor{stringliteral}{"{},"{}})}
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00085}00085\ print(\textcolor{stringliteral}{"{}Items\ included\ in\ performance\ gap\ scan:\ \{\}"{}}.format(Scanlist))}
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00086}00086\ }
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00087}00087\ \textcolor{comment}{\#df\ =\ EventCategorizerFcn([list(Finalcategories),Finalcategories.values.tolist()],\ EventData,\ Finalcategories,\ "{}event\_Sbd\_sw\_24\_1.2"{})}}
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00088}\mbox{\hyperlink{namespace_trackn_trace_1_1categorizer_1_1categorizer_ab52c96bea30646abf8170f333bbd42b9}{00088}}\ df\ =\ \mbox{\hyperlink{namespace_trackn_trace_1_1categorizer_1_1categorizer_a383060e49080dec23300b5de83f90b1b}{DoAllCategories}}([list(Finalcategories),Finalcategories.values.tolist()],\ EventData,\ Finalcategories,\ ScanList\ =\ Scanlist)}
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00089}00089\ }
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00090}00090\ print(df)}
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00091}00091\ }
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00092}\mbox{\hyperlink{namespace_trackn_trace_1_1categorizer_1_1categorizer_a64aa603bc3c6c1587e7c6542452481ac}{00092}}\ fig\ =\ df.plot()}
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00093}\mbox{\hyperlink{namespace_trackn_trace_1_1categorizer_1_1categorizer_ab10971f075ec46b36e4afcb087e25a80}{00093}}\ fig.write\_html(\textcolor{stringliteral}{"{}\{\}\_FinalCategories.html"{}}.format(args.instance),\ auto\_open=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00094}\mbox{\hyperlink{namespace_trackn_trace_1_1categorizer_1_1categorizer_a5f884becb0a8f606430cf34e5fa9c3da}{00094}}\ dfnorm\ =\ df/df.max()}
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00095}00095\ }
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00096}00096\ fig\ =\ dfnorm.plot()}
\DoxyCodeLine{\Hypertarget{categorizer_8py_source_l00097}00097\ fig.write\_html(\textcolor{stringliteral}{"{}\{\}\_FinalCategories\_normalized.html"{}}.format(args.instance),\ auto\_open=\textcolor{keyword}{True})}

\end{DoxyCode}
